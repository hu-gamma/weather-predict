# 高安市天气预测项目

## 项目简介

本项目旨在利用机器学习和深度学习技术，基于高安市过去五年的气象数据，构建一个能够准确预测该地区未来天气状况、气温变化及湿度水平的气象预测模型。通过对历史气象数据的采集与分析，挖掘气象因子之间的内在关联规律，提升气象预测的精度与实用性，为当地应对气候变化和相关决策提供科学依据。

## 数据来源

项目所用数据来源于 [rp5.ru](http://rp5.ru/) 对天气记录的整理，数据涵盖了时间、气压、气温、湿度、天气类型等气象学基本特征。

## 数据分析与预处理

### 数据预处理

1. 使用 pandas 读取数据，分析数据结构。
2. 通过 datetime 函数对时间索引重新排列。
3. 分析数据间相关性，去除无关列（如“ff10”等）。
4. 将字符类型数据转换为数值类型，可采用独热编码。
5. 对缺失值进行填充，利用前后采样点的温度、相关性等进行填补。

### 相关性分析

绘制数据特征间的相关性热力图，发现天气与气压之间存在明显的负相关关系，这为后续的预测模型提供了重要依据。

## 模型训练与预测

### 分类模型

采用 BP 神经网络、XGBoost 模型和极端树模型进行天气类型的多分类预测。训练时对数据进行标准化处理，并转换为 torch 张量，同时保留 numpy 格式数据以适配传统机器学习模型。模型评估结果如下：

* BPNN Accuracy: 0.6880356530682208
* XGBoost Accuracy: 0.7123757284881728
* ExtraTrees Accuracy: 0.7271169009256085

### 回归模型

对气温和湿度进行回归预测，考虑到气温的时序特征，使用 LSTM 模型和 Transformer 模型进行训练，并与 SVM 模型进行比较。

这部分数据写在[TemptureRegression.ipynb](/TemptureRegression.ipynb)内

气温预测的相对百分比误差（RPE）如下：

* Transformer RPE: 35.24%
* SVM RPE: 34.25%
* LSTM RPE: 35.37%

## 结论

本项目所构建的模型在一定程度上能够捕捉到湿度和温度的变化趋势，但预测精度仍有待提高。未来的研究方向包括引入更多特征变量、优化模型参数、探索更先进的算法，以及在数据收集和预处理阶段更加谨慎和细致，以进一步提升模型的预测性能。
